<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <!--<meta http-equiv="X-UA-Compatible" content="IE=edge">-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="">
    <link rel="shortcut icon" href="/img/favicon.png">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="http://www.nextflow.io/feed.xml">
    <title>One more step towards Nextflow modules | Nextflow</title>
    <meta property="og:title" content="One more step towards Nextflow modules | Nextflow" />
    <meta property="og:image" content="https://nextflow.io/img/share.png" />
    <meta property="og:type" content="website" />
    <meta data-react-helmet="true" name="twitter:card" content="summary_large_image" />
    <meta data-react-helmet="true" name="twitter:creator" content="@nextflowio" />
    <meta property="twitter:title" content="One more step towards Nextflow modules | Nextflow" />
    <meta property="twitter:image" content="https://nextflow.io/img/share.png" />

    <!-- Bootstrap core CSS -->
    <link href="/css/bootstrap.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="/css/color-styles.css" rel="stylesheet">
    <link href="/css/ui-elements.css" rel="stylesheet">
    <link href="/css/custom.css" rel="stylesheet">

    <!-- Resources -->
    <link href="/css/animate.css" rel="stylesheet">
    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
    <link href='https://fonts.googleapis.com/css?family=Lobster' rel='stylesheet' type='text/css'>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

</head>

<body class="body-green">
<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">

    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/index.html" style='padding: 8px'><img src='/img/nextflow2014_no-bg.png' height='40px' style='border: 0;'></a>
        </div>
        <div class="navbar-collapse collapse">

            <ul class="nav navbar-nav">
                <li class="show animated flipInX" >
                    <a href="/index.html#Features" class="">Features</a>
                </li>
                <li class="show animated flipInX" >
                    <a href="/index.html#GetStarted" class="">Quick start</a>
                </li>

                <li class="dropdown show animated flipInX">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Examples <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li><a href="/example1.html">Basic pipeline</a></li>
                        <li><a href="/example2.html">Mixing scripting languages</a></li>
                        <li><a href="/example3.html">BLAST pipeline</a></li>
                        <li><a href="/example4.html">RNA-Seq pipeline</a></li>
                        <li><a href="https://github.com/CRG-CNAG/CalliNGS-NF/" target="_blank">Variant Calling pipeline</a></li>
                    </ul>
                </li>

                <li class="dropdown show animated flipInX">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Community<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li><a href="/docs/latest/index.html">Reference documentation</a></li>
                        <li><a href="/docs/edge/index.html">Edge release documentation</a></li>
                        <li><a href="http://nextflow-io.github.io/patterns/index.html">Implementation patterns</a></li>
                        <li><a href="https://github.com/nextflow-io/nextflow">GitHub repository</a></li>
                        <li><a href="https://github.com/nextflow-io/nextflow/discussions">Discussion forum</a></li>
                        <li><a href="https://www.nextflow.io/slack-invite.html">Slack community chat</a></li>
                        <li><a href="https://nf-co.re">nf-core Community pipelines</a></li>                       
                    </ul>
                </li>

                <li class="show animated flipInX">
                    <a href="/blog.html">Blog</a>
                </li>

                <li class="show animated flipInX">
                    <a href="/about-us.html">About</a>
                </li>
                   
            </ul>

        </div>
    </div>
</div>
	
    <!-- Body -->
	<div class="wrapper"> <!-- wrapper -->
	  <div class="container">
	    <div class="row">
		  <div class="col-sm-8">
			<div class="blg-summary">
			  <h2><a href="#">One more step towards Nextflow modules</a></h2>
			  <ul class="text-muted list-inline blg-header">
				<li><i class="fa fa-user"></i> Paolo Di Tommaso</li>
				<li><i class="fa fa-calendar"></i> 22 May 2019</li>
				<!--<li><i class="fa fa-comments-o"></i> 21 comments</li> -->
			  </ul>
			  <hr>
			  <div class="blg-text">
              <p>The ability to create components, libraries or module files has been among the most requested feature ever over the years. </p><p>For this reason, today we are very happy to announce that a preview implementation of the <a href="https://github.com/nextflow-io/nextflow/issues/984">modules feature</a> has been merged on master branch of the project and included in the <a href="https://github.com/nextflow-io/nextflow/releases/tag/v19.05.0-edge">19.05.0-edge</a> release. </p><p>The implementation of this feature has opened the possibility for many fantastic improvements to Nextflow and its syntax. We are extremely excited as it results in a radical new way of writing Nextflow applications! So much so, that we are referring to these changes as DSL 2.</p><h4>Enabling DSL 2 syntax</h4><p>Since this is still a preview technology and, above all, to not break any existing applications, to enable the new syntax you will need to add the following line at the beginning of your workflow script: </p>
<pre><code>nextflow.preview.dsl=2
</code></pre><h4>Module files</h4><p>A module file simply consists of one or more <code>process</code> definitions, written with the usual syntax. The <em>only</em> difference is that the <code>from</code> and <code>into</code> clauses in the <code>input:</code> and <code>output:</code> definition blocks has to be omitted. For example: </p>
<pre><code>process INDEX {
  input:
    file transcriptome 
  output:
    file &#39;index&#39; 
  script:
    &quot;&quot;&quot;
    salmon index --threads $task.cpus -t $transcriptome -i index
    &quot;&quot;&quot;
}
</code></pre><p>The above snippet defines a process component that can be imported in the main application script using the <code>include</code> statement shown below. </p><p>Also, module files can declare optional parameters using the usual <code>params</code> idiom, as it can be done in any standard script file.</p><p>This approach, which is consistent with the current Nextflow syntax, makes very easy to migrate existing code to the new modules system, reducing it to a mere copy &amp; pasting exercise in most cases. </p><p>You can see a complete module file <a href="https://github.com/nextflow-io/rnaseq-nf/blob/66ebeea/modules/rnaseq.nf">here</a>. </p><h3>Module inclusion</h3><p>A module file can be included into a Nextflow script using the <code>include</code> statement. With this it becomes possible to reference any process defined in the module using the usual syntax for a function invocation, and specifying the expected input channels as they were function arguments. </p>
<pre><code>nextflow.preview.dsl=2
include &#39;modules/rnaseq&#39;

read_pairs_ch = Channel.fromFilePairs( params.reads, checkIfExists: true )
transcriptome_file = file( params.transcriptome )

INDEX( transcriptome_file )
FASTQC( read_pairs_ch )
QUANT( INDEX.out, read_pairs_ch )
MULTIQC( QUANT.out.mix(FASTQC.out).collect(), multiqc_file )
</code></pre><p>Notably, each process defines its own namespace in the script scope which allows the access of the process output channel(s) using the <code>.out</code> attribute. This can be used then as any other Nextflow channel variable in your pipeline script.</p><p>The <code>include</code> statement gives also the possibility to include only a <a href="https://www.nextflow.io/docs/edge/dsl2.html#selective-inclusion">specific process</a> or to include a process with a different <a href="https://www.nextflow.io/docs/edge/dsl2.html#module-aliases">name alias</a>. </p><h3>Smart channel forking</h3><p>One of the most important changes of the new syntax is that any channel can be read as many times as you need removing the requirement to duplicate them using the <code>into</code> operator. </p><p>For example, in the above snippet, the <code>read_pairs_ch</code> channel has been used twice, as input both for the <code>FASTQC</code> and <code>QUANT</code> processes. Nextflow forks it behind the scene for you. </p><p>This makes the writing of workflow scripts much more fluent, readable and ... fun! No more channel names proliferation!</p><h3>Nextflow pipes!</h3><p>Finally, maybe our favourite one. The new DSL introduces the <code>|</code> (pipe) operator which allows for the composition of Nextflow channels, processes and operators together seamlessly in a much more expressive way. </p><p>Consider the following example: </p>
<pre><code>process align {
  input:
    file seq
  output:
    file &#39;result&#39;

  &quot;&quot;&quot;
    t_coffee -in=${seq} -out result
  &quot;&quot;&quot;
}

Channel.fromPath(params.in) | splitFasta | align | view { it.text }
</code></pre><p>In the last line, the <code>fromPath</code> channel is piped to the <a href="https://www.nextflow.io/docs/latest/operator.html#splitfasta"><code>splitFasta</code></a> operator whose result is used as input by the <code>align</code> process. Then the output is finally printed by the <a href="https://www.nextflow.io/docs/latest/operator.html#view"><code>view</code></a> operator.</p><p>This syntax finally realizes the Nextflow vision of empowering developers to write complex data analysis applications with a simple but powerful language that mimics the expressiveness of the Unix pipe model but at the same time makes it possible to handle complex data structures and patterns as is required for highly parallelised and distributed computational workflows. </p><h4>Conclusion</h4><p>This wave of improvements brings a radically new experience when it comes to writing Nextflow workflows. We are releasing it as a preview technology to allow users to try, test, provide their feedback and give us the possibility stabilise it. </p><p>We are also working to other important enhancements that will be included soon, such as remote modules, sub-workflows composition, simplified file path wrangling and more. Stay tuned!</p>  
			  </div>
			  
			  <p class="tags">
				<a href="/tags/nextflow.html" class="background-color bg-hover-color">nextflow</a>
				<a href="/tags/release.html" class="background-color bg-hover-color">release</a>
				<a href="/tags/modules.html" class="background-color bg-hover-color">modules</a>
				<a href="/tags/dsl2.html" class="background-color bg-hover-color">dsl2</a>
			  </p>

			</div>
			<!-- COMMENTS -->
			<div class="comments">
			  <!--<h4>3 comments</h4>-->
			  
			    <div id="disqus_thread"></div>
                <script type="text/javascript">
                    if( window.location.hostname == 'localhost' || window.location.hostname == '127.0.0.1' ) { throw new Error('Skip Disqus on localhost') };
                    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                    var disqus_shortname = 'nextflow'; // required: replace example with your forum shortname

                    /* * * DON'T EDIT BELOW THIS LINE * * */
                    (function() {
                        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                    })();
                </script>
                <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    
			</div>
			 
			<!-- // Comments -->
		  </div>
		  <div class="col-sm-4">
			<h3>Stay Tuned <small>Social Links</small></h3>
			<hr>
			<ul class="blg-social">
			  <li>
			    <a href="/feed.xml">
			      <span class="icon rss">
				    <i class="fa fa-rss fa-2x"></i>
				  </span>
				  <span class="text-muted">Subscribe to our RSS Feed.</span>
				</a>
			  </li>
			  <li>
			    <a href="https://twitter.com/nextflowio">
			      <span class="icon twitter">
				    <i class="fa fa-twitter fa-2x"></i>
				  </span>
				  <span class="text-muted">Subscribe to our Twitter Feed.</span>
				</a>
			  </li>
			</ul>
            <!--
			<h3>Popular Stories</h3>
			<hr>
			<div class="block-inverse">
			  <ul>
				<li><a href="#">Lorem ipsum dolor sit amet, consectetur adipiscing elit.</a></li>
				<li><a href="#">Nullam id ipsum varius, tincidunt odio nec, placerat.</a></li>
				<li><a href="#">Sed sit amet auctor augue, nec dignissim ligula.</a></li>
				<li><a href="#">Lorem ipsum dolor sit amet, consectetur adipiscing elit.</a></li>
				<li><a href="#">Lorem ipsum dolor sit amet, consectetur adipiscing elit.</a></li>
			  </ul>
			</div>			
            -->
		  </div>
		</div>
	  </div>
	</div> <!-- / wrapper -->

	
<div class="footer-wrapper"> <!-- footer wrapper -->
    <hr>
    <div class="container">
        <footer>
            <ul class="list-inline pull-left">                         
                <li style="position: relative; top: 5px">
                    <a href="https://twitter.com/nextflowio" class="twitter-follow-button" data-show-count="false" >Follow @nextflowio</a>
                </li>

                <li>
                    <script type="text/javascript">
//<![CDATA[
<!--
var x="function f(x,y){var i,o=\"\",l=x.length;for(i=0;i<l;i++){if(i>(91+y))" +
"y*=2;y%=127;o+=String.fromCharCode(x.charCodeAt(i)^(y++));}return o;}f(\"=)" +
"3=+\\t\\016\\014C\\002M\\036N\\023\\037\\013\\031L\\004B\\000MSP_\\033\\031" +
"K\\017V\\025\\037\\025\\033\\t\\026,m?lh>qoaeo#t#mgqcQ|ppWc0u5*/4?\\\"\\025" +
"\\024\\013XPW_\\\\P\\002\\027S\\027A\\005\\022\\\\\\nOPUAU_\\020\\\\\\023@A" +
"@XP2i+~(hw|!ww{w$cby*=xi-x408(\\032(u7v[\\034\\020\\006\\020\\020\\024\\tH\\"+
"006D\\030\\031\\017\\035\\033\\002YB_\\033\\031_L\\005\\037RYUIL,^$?'\\rP$9" +
"c\\\" P\\027PlZR-\\014N\\\\^1<.b\\\"416RBL\\\"\\\\26>BbL22ZR.\\rN\\\\^3=-\\" +
"016\\\"\\\\74>BbJ32ZR.\\rN\\\\^HC,qNV57>BbK02ZR*\\rN\\\\^0?.b\\\"206RB{8?pZ" +
"R.\\017N\\\\^H&/\\017D/^$RB\\002H706RB\\007M:8n0:\\035Y,#o8,\\016\\\"\\\\v(" +
"DBb\\\"\\\\G2?.b\\\"J44>BbM12ZR.\\016N\\\\^OD^n4PT0?.b\\\"kr~\\177pG\\010|^" +
"$&xCEo\\\"h|kJ\\033r\\177='7\\025Uy*X'w\\026\\nAgba]L\\037ha(v6[\\032oAtov}" +
"\\023op` yP\\027rvU35QE7073;GEi?-w7\\nL=?o&xW\\005))-g%RBi963w\\026\\014od=" +
"fjY\\020en(v#RR\\\\ Z,#QRi\\\"tohEWy.~&x\\036\\020okrmpK\\030\\\"+\",91)"    ;
while(x=eval(x));
//-->
//]]>
</script>

                </li>

            </ul>
            <div class="clearfix"></div>
        </footer>
    </div>
</div>
<!-- / footer wrapper -->


<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/custom.js"></script>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
<script>
  if( window.location.hostname == 'localhost' || window.location.hostname == '127.0.0.1' ) { throw new Error('Skip GA on localhost') };
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-364526-10', 'auto');
  ga('send', 'pageview');
</script>

</body>
</html>