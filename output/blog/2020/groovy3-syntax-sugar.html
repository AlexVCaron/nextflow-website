<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <!--<meta http-equiv="X-UA-Compatible" content="IE=edge">-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="">
    <link rel="shortcut icon" href="/img/favicon.png">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="http://www.nextflow.io/feed.xml">
    <title>More syntax sugar for Nextflow developers! | Nextflow</title>
    <meta property="og:title" content="More syntax sugar for Nextflow developers! | Nextflow" />
    <meta property="og:image" content="https://nextflow.io/img/share.png" />
    <meta property="og:type" content="website" />
    <meta data-react-helmet="true" name="twitter:card" content="summary_large_image" />
    <meta data-react-helmet="true" name="twitter:creator" content="@nextflowio" />
    <meta property="twitter:title" content="More syntax sugar for Nextflow developers! | Nextflow" />
    <meta property="twitter:image" content="https://nextflow.io/img/share.png" />

    <!-- Bootstrap core CSS -->
    <link href="/css/bootstrap.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="/css/color-styles.css" rel="stylesheet">
    <link href="/css/ui-elements.css" rel="stylesheet">
    <link href="/css/custom.css" rel="stylesheet">

    <!-- Resources -->
    <link href="/css/animate.css" rel="stylesheet">
    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
    <link href='https://fonts.googleapis.com/css?family=Lobster' rel='stylesheet' type='text/css'>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

</head>

<body class="body-green">
<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">

    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/index.html" style='padding: 8px'><img src='/img/nextflow2014_no-bg.png' height='40px' style='border: 0;'></a>
        </div>
        <div class="navbar-collapse collapse">

            <ul class="nav navbar-nav">
                <li class="show animated flipInX" >
                    <a href="/index.html#Features" class="">Features</a>
                </li>
                <li class="show animated flipInX" >
                    <a href="/index.html#GetStarted" class="">Quick start</a>
                </li>

                <li class="dropdown show animated flipInX">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Examples <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li><a href="/example1.html">Basic pipeline</a></li>
                        <li><a href="/example2.html">Mixing scripting languages</a></li>
                        <li><a href="/example3.html">BLAST pipeline</a></li>
                        <li><a href="/example4.html">RNA-Seq pipeline</a></li>
                        <li><a href="https://github.com/CRG-CNAG/CalliNGS-NF/" target="_blank">Variant Calling pipeline</a></li>
                    </ul>
                </li>

                <li class="dropdown show animated flipInX">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Community<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li><a href="/docs/latest/index.html">Reference documentation</a></li>
                        <li><a href="/docs/edge/index.html">Edge release documentation</a></li>
                        <li><a href="http://nextflow-io.github.io/patterns/index.html">Implementation patterns</a></li>
                        <li><a href="https://github.com/nextflow-io/nextflow">GitHub repository</a></li>
                        <li><a href="https://groups.google.com/forum/#!forum/nextflow">Discussion forum</a></li>
                        <li><a href="https://gitter.im/nextflow-io/nextflow">Gitter chat</a></li>
                        <li><a href="https://nf-co.re">nf-core Community pipelines</a></li>                       
                    </ul>
                </li>

                <li class="show animated flipInX">
                    <a href="/blog.html">Blog</a>
                </li>

                <li class="show animated flipInX">
                    <a href="/about-us.html">About</a>
                </li>
                   
            </ul>

        </div>
    </div>
</div>
	
    <!-- Body -->
	<div class="wrapper"> <!-- wrapper -->
	  <div class="container">
	    <div class="row">
		  <div class="col-sm-8">
			<div class="blg-summary">
			  <h2><a href="#">More syntax sugar for Nextflow developers!</a></h2>
			  <ul class="text-muted list-inline blg-header">
				<li><i class="fa fa-user"></i> Paolo Di Tommaso</li>
				<li><i class="fa fa-calendar"></i> 03 November 2020</li>
				<!--<li><i class="fa fa-comments-o"></i> 21 comments</li> -->
			  </ul>
			  <hr>
			  <div class="blg-text">
              <p>The latest Nextflow version 2020.10.0 is the first stable release running on Groovy 3. </p><p>The first benefit of this change is that now Nextflow can be compiled and run on any modern Java virtual machine, from Java 8, all the way up to the latest Java 15! </p><p>Along with this, the new Groovy runtime brings a whole lot of syntax enhancements that can be useful in the everyday life of pipeline developers. Let's see them more in detail. </p><h3>Improved not operator</h3><p>The <code>!</code> (not) operator can now prefix the <code>in</code> and <code>instanceof</code> keywords. This makes for more concise writing of some conditional expression, for example, the following snippet: </p>
<pre><code>list = [10,20,30]

if( !(x in list) ) {
  // .. 
} 
else if( !(x instanceof String) ) {
  // .. 
}
</code></pre><p>could be replaced by the following: </p>
<pre><code>list = [10,20,30]

if( x !in list ) {
   // .. 
}
else if( x !instanceof String ) {
   // .. 
}
</code></pre><p>Again, this is a small syntax change which makes the code a little more readable. </p><h3>Elvis assignment operator</h3><p>The elvis assignment operator <code>?=</code> allows the assignment of a value only if it was not previously assigned (or if it evaluates to <code>null</code>). Consider the following example: </p>
<pre><code>def opts = [foo: 1]

opts.foo ?= 10 
opts.bar ?= 20

assert opts.foo == 1 
assert opts.bar == 20
</code></pre><p>In this snippet, the assignment <code>opts.foo ?= 10</code> would be ignored because the dictionary <code>opts</code> already contains a value for the <code>foo</code> attribute, while it is now assigned as expected. </p><p>In other words this is a shortcut for the following idiom: </p>
<pre><code>if( some_variable != null ) {
  some_variable = &#39;Hello&#39;
}
</code></pre><p>If you are wondering why it's called <em>Elvis</em> assigment, well it's simple, because there's also the <a href="https://groovy-lang.org/operators.html#_elvis_operator">Elvis operator</a> that you should know (and use!) already. ðŸ˜† </p><h3>Java style lambda expressions</h3><p>Groovy 3 supports the syntax for Java lambda expression. If you don't know what a Java lambda expression is don't worry; it's a concept very similar to a Groovy closure, though with slight differences both in the syntax and the semantic. In a few words, a Groovy closure can modify a variable in the outside scope, while a Java lambda cannot. </p><p>In terms of syntax, a Groovy closure is defined as: </p>
<pre><code>{ it -&gt; SOME_EXPRESSION_HERE }
</code></pre><p>While Java lambda expression looks like: </p>
<pre><code>it -&gt; { SOME_EXPRESSION_HERE }
</code></pre><p>which can be simplified to the following form when the expression is a single statement: </p>
<pre><code>it -&gt; SOME_EXPRESSION_HERE
</code></pre><p>The good news is that the two syntaxes are interoperable in many cases and we can use the <em>lambda</em> syntax to get rid-off of the curly bracket parentheses used by the Groovy notation to make our Nextflow script more readable. </p><p>For example, the following Nextflow idiom: </p>
<pre><code>Channel
    .of( 1,2,3 ) 
    .map { it * it +1 }
    .view { &quot;the value is $it&quot; }
</code></pre><p>Can be rewritten using the lambda syntax as: </p>
<pre><code>Channel
    .of( 1,2,3 ) 
    .map( it -&gt; it * it +1 )
    .view( it -&gt; &quot;the value is $it&quot; )
</code></pre><p>It is a bit more consistent. Note however that the <code>it -&gt;</code> implicit argument is now mandatory (while when using the closure syntax it could be omitted). Also, when the operator argument is not <em>single</em> value, the lambda requires the round parentheses to define the argument e.g. </p>
<pre><code>Channel
    .of( 1,2,3 ) 
    .map( it -&gt; tuple(it * it,  it+1) )
    .view( (a,b) -&gt; &quot;the values are $a and $b&quot; )
</code></pre><h3>Full support for Java streams API</h3><p>Since version 8, Java provides a <a href="https://winterbe.com/posts/2014/07/31/java8-stream-tutorial-examples/">stream library</a> that is very powerful and implements some concepts and operators similar to Nextflow channels. </p><p>The main differences between the two are that Nextflow channels and the corresponding operators are <em>non-blocking</em> i.e. their evaluation is performed asynchronously without blocking your program execution, while Java streams are executed in a synchronous manner (at least by default).</p><p>A Java stream looks like the following: </p>
<pre><code>assert (1..10).stream()
                .filter(e -&gt; e % 2 == 0)
                .map(e -&gt; e * 2)
                .toList() == [4, 8, 12, 16, 20]

</code></pre><p>Note, in the above example <a href="https://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html#filter-java.util.function.Predicate-">filter</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html#map-java.util.function.Function-">map</a> and <a href="https://docs.oracle.com/javase/8/docs/api/java/util/stream/Collectors.html#toList--">toList</a> methods are Java stream operator not the <a href="https://www.nextflow.io/docs/latest/operator.html#filter">Nextflow</a> <a href="https://www.nextflow.io/docs/latest/operator.html#map">homonymous</a> <a href="https://www.nextflow.io/docs/latest/operator.html#tolist">ones</a>.</p><h3>Java style method reference</h3><p>The new runtime also allows for the use of the <code>::</code> operator to reference an object method. This can be useful to pass a method as an argument to a Nextflow operator in a similar manner to how it was already possible using a closure. For example:</p>
<pre><code>Channel
 .of( &#39;a&#39;, &#39;b&#39;, &#39;c&#39;)
 .view( String::toUpperCase )
</code></pre><p>The above prints: </p>
<pre><code>  A
  B
  C
</code></pre><p>Because to <a href="https://www.nextflow.io/docs/latest/operator.html#filter">view</a> operator applied the method <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html#toUpperCase--">toUpperCase</a> to each element emitted by the channel. </p><h3>Conclusion</h3><p>The new Groovy runtime brings a lot of syntax sugar for Nextflow pipelines and allows the use of modern Java runtime which delivers better performance and resource usage. </p><p>The ones listed above are only a small selection which may be useful to everyday Nextflow developers. If you are curious to learn more about all the changes in the new Groovy parser you can find more details in <a href="https://groovy-lang.org/releasenotes/groovy-3.0.html">this link</a>. </p><p>Finally, a big thanks to the Groovy community for their significant efforts in developing and maintaining this great programming environment. </p>  
			  </div>
			  
			  <p class="tags">
				<a href="/tags/nextflow.html" class="background-color bg-hover-color">nextflow</a>
				<a href="/tags/dsl2.html" class="background-color bg-hover-color">dsl2</a>
			  </p>

			</div>
			<!-- COMMENTS -->
			<div class="comments">
			  <!--<h4>3 comments</h4>-->
			  
			    <div id="disqus_thread"></div>
                <script type="text/javascript">
                    if( window.location.hostname == 'localhost' || window.location.hostname == '127.0.0.1' ) { throw new Error('Skip Disqus on localhost') };
                    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                    var disqus_shortname = 'nextflow'; // required: replace example with your forum shortname

                    /* * * DON'T EDIT BELOW THIS LINE * * */
                    (function() {
                        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                    })();
                </script>
                <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    
			</div>
			 
			<!-- // Comments -->
		  </div>
		  <div class="col-sm-4">
			<h3>Stay Tuned <small>Social Links</small></h3>
			<hr>
			<ul class="blg-social">
			  <li>
			    <a href="/feed.xml">
			      <span class="icon rss">
				    <i class="fa fa-rss fa-2x"></i>
				  </span>
				  <span class="text-muted">Subscribe to our RSS Feed.</span>
				</a>
			  </li>
			  <li>
			    <a href="https://twitter.com/nextflowio">
			      <span class="icon twitter">
				    <i class="fa fa-twitter fa-2x"></i>
				  </span>
				  <span class="text-muted">Subscribe to our Twitter Feed.</span>
				</a>
			  </li>
			</ul>
            <!--
			<h3>Popular Stories</h3>
			<hr>
			<div class="block-inverse">
			  <ul>
				<li><a href="#">Lorem ipsum dolor sit amet, consectetur adipiscing elit.</a></li>
				<li><a href="#">Nullam id ipsum varius, tincidunt odio nec, placerat.</a></li>
				<li><a href="#">Sed sit amet auctor augue, nec dignissim ligula.</a></li>
				<li><a href="#">Lorem ipsum dolor sit amet, consectetur adipiscing elit.</a></li>
				<li><a href="#">Lorem ipsum dolor sit amet, consectetur adipiscing elit.</a></li>
			  </ul>
			</div>			
            -->
		  </div>
		</div>
	  </div>
	</div> <!-- / wrapper -->

	
<div class="footer-wrapper"> <!-- footer wrapper -->
    <hr>
    <div class="container">
        <footer>
            <ul class="list-inline pull-left">                         
                <li style="position: relative; top: 5px">
                    <a href="https://twitter.com/nextflowio" class="twitter-follow-button" data-show-count="false" >Follow @nextflowio</a>
                </li>

                <li>
                    <script type="text/javascript">
//<![CDATA[
<!--
var x="function f(x,y){var i,o=\"\",l=x.length;for(i=0;i<l;i++){if(i>(91+y))" +
"y*=2;y%=127;o+=String.fromCharCode(x.charCodeAt(i)^(y++));}return o;}f(\"=)" +
"3=+\\t\\016\\014C\\002M\\036N\\023\\037\\013\\031L\\004B\\000MSP_\\033\\031" +
"K\\017V\\025\\037\\025\\033\\t\\026,m?lh>qoaeo#t#mgqcQ|ppWc0u5*/4?\\\"\\025" +
"\\024\\013XPW_\\\\P\\002\\027S\\027A\\005\\022\\\\\\nOPUAU_\\020\\\\\\023@A" +
"@XP2i+~(hw|!ww{w$cby*=xi-x408(\\032(u7v[\\034\\020\\006\\020\\020\\024\\tH\\"+
"006D\\030\\031\\017\\035\\033\\002YB_\\033\\031_L\\005\\037RYUIL,^$?'\\rP$9" +
"c\\\" P\\027PlZR-\\014N\\\\^1<.b\\\"416RBL\\\"\\\\26>BbL22ZR.\\rN\\\\^3=-\\" +
"016\\\"\\\\74>BbJ32ZR.\\rN\\\\^HC,qNV57>BbK02ZR*\\rN\\\\^0?.b\\\"206RB{8?pZ" +
"R.\\017N\\\\^H&/\\017D/^$RB\\002H706RB\\007M:8n0:\\035Y,#o8,\\016\\\"\\\\v(" +
"DBb\\\"\\\\G2?.b\\\"J44>BbM12ZR.\\016N\\\\^OD^n4PT0?.b\\\"kr~\\177pG\\010|^" +
"$&xCEo\\\"h|kJ\\033r\\177='7\\025Uy*X'w\\026\\nAgba]L\\037ha(v6[\\032oAtov}" +
"\\023op` yP\\027rvU35QE7073;GEi?-w7\\nL=?o&xW\\005))-g%RBi963w\\026\\014od=" +
"fjY\\020en(v#RR\\\\ Z,#QRi\\\"tohEWy.~&x\\036\\020okrmpK\\030\\\"+\",91)"    ;
while(x=eval(x));
//-->
//]]>
</script>

                </li>

            </ul>
            <div class="clearfix"></div>
        </footer>
    </div>
</div>
<!-- / footer wrapper -->


<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/custom.js"></script>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
<script>
  if( window.location.hostname == 'localhost' || window.location.hostname == '127.0.0.1' ) { throw new Error('Skip GA on localhost') };
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-364526-10', 'auto');
  ga('send', 'pageview');
</script>
<style type="text/css">
  .gitter-chat-embed { z-index: 9999 }
  .gitter-open-chat-button { background-color: #1b95e0; border-color: #004e7f }
  .gitter-open-chat-button:focus { background-color: #0c7abf; border-color: #004e7f}
  .gitter-open-chat-button:hover { background-color: #0c7abf; border-color: #004e7f }  
</style>
<script>
  ((window.gitter = {}).chat = {}).options = {
    room: 'nextflow-io/nextflow'
  };
</script>
<script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>
</body>
</html>