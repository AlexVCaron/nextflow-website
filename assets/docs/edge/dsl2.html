

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>DSL 2 &mdash; Nextflow 20.04.1-edge documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Nextflow 20.04.1-edge documentation" href="index.html"/>
        <link rel="next" title="Amazon Cloud" href="awscloud.html"/>
        <link rel="prev" title="Configuration" href="config.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Nextflow
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getstarted.html">Get started</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic.html">Basic concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="script.html">Nextflow scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="process.html">Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="channel.html">Channels</a></li>
<li class="toctree-l1"><a class="reference internal" href="operator.html">Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="executor.html">Executors</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configuration</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">DSL 2</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#function">Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="#process">Process</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#process-definition">Process definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="#process-composition">Process composition</a></li>
<li class="toctree-l3"><a class="reference internal" href="#process-outputs">Process outputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#process-named-output">Process named output</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#workflow">Workflow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#workflow-definition">Workflow definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="#workflow-parameters">Workflow parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#workflow-inputs">Workflow inputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#workflow-outputs">Workflow outputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#implicit-workflow">Implicit workflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="#workflow-publish">Workflow publish</a></li>
<li class="toctree-l3"><a class="reference internal" href="#workflow-composition">Workflow composition</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#modules">Modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#modules-include">Modules include</a></li>
<li class="toctree-l3"><a class="reference internal" href="#multiple-inclusions">Multiple inclusions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-aliases">Module aliases</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-parameters">Module parameters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#channel-forking">Channel forking</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pipes">Pipes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-pipe-operator">The <em>pipe</em> operator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-and-operator">The <em>and</em> operator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#deprecated-methods-and-operators">Deprecated methods and operators</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="awscloud.html">Amazon Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="amazons3.html">Amazon S3 storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="google.html">Google Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="conda.html">Conda environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="docker.html">Docker containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="shifter.html">Shifter Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="singularity.html">Singularity containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="podman.html">Podman containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="ignite.html">Apache Ignite</a></li>
<li class="toctree-l1"><a class="reference internal" href="kubernetes.html">Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="tracing.html">Tracing &amp; visualisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="sharing.html">Pipeline sharing</a></li>
<li class="toctree-l1"><a class="reference internal" href="metadata.html">Workflow introspection</a></li>
<li class="toctree-l1"><a class="reference internal" href="mail.html">Mail &amp; Notifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="example.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Nextflow</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>DSL 2</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="dsl-2">
<span id="dsl2-page"></span><h1>DSL 2<a class="headerlink" href="#dsl-2" title="Permalink to this headline">¶</a></h1>
<p>Nextflow implements an experimental syntax that implements new features and enhancements that
simplifies the implementation of data analysis applications.</p>
<p>To enable this feature you need to defined the following directive at the beginning of
your workflow script:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nextflow</span><span class="o">.</span><span class="n">preview</span><span class="o">.</span><span class="n">dsl</span><span class="o">=</span><span class="mi">2</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">THIS IS AN EXPERIMENT FEATURE UNDER DEVELOPMENT. SYNTAX MAY CHANGE IN FUTURE RELEASE.</p>
</div>
<div class="section" id="function">
<h2>Function<a class="headerlink" href="#function" title="Permalink to this headline">¶</a></h2>
<p>Nextflow allows the definition of custom function in the workflow script using the following syntax:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>def &lt;function name&gt; ( arg1, arg, .. ) {
    &lt;function body&gt;
}
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">foo</span><span class="p">()</span> <span class="p">{</span>
    <span class="s1">&#39;Hello world&#39;</span>
<span class="p">}</span>

<span class="k">def</span> <span class="nf">bar</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">omega</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">alpha</span> <span class="o">+</span> <span class="n">omega</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The above snippet defines two simple functions, that can be invoked in the workflow script as <code class="docutils literal"><span class="pre">foo()</span></code> which
returns the <code class="docutils literal"><span class="pre">Hello</span> <span class="pre">world</span></code> string and <code class="docutils literal"><span class="pre">bar(10,20)</span></code> which return the sum of two parameters.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Functions implicitly return the result of the last evaluated statement.</p>
</div>
<p>The keyword <code class="docutils literal"><span class="pre">return</span></code> can be used to explicitly exit from a function returning the specified value.
for example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fib</span><span class="p">(</span> <span class="n">x</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">1</span> <span class="p">)</span>
        <span class="k">return</span> <span class="n">x</span>
    <span class="k">else</span>
        <span class="n">fib</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">fib</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="process">
<h2>Process<a class="headerlink" href="#process" title="Permalink to this headline">¶</a></h2>
<div class="section" id="process-definition">
<h3>Process definition<a class="headerlink" href="#process-definition" title="Permalink to this headline">¶</a></h3>
<p>The new DSL separates the definition of a process by its invocation. The process definition follows the usual
for syntax as described in the <a class="reference internal" href="process.html#process-page"><span class="std std-ref">process documentation</span></a>. The only difference is that the
<code class="docutils literal"><span class="pre">from</span></code> and <code class="docutils literal"><span class="pre">into</span></code> channel declaration has to be omitted.</p>
<p>Then a process can be invoked as a function in the <code class="docutils literal"><span class="pre">workflow</span></code> scope, passing the expected
input channels as parameters as it if were a custom function. For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nextflow</span><span class="o">.</span><span class="n">preview</span><span class="o">.</span><span class="n">dsl</span><span class="o">=</span><span class="mi">2</span>

<span class="n">process</span> <span class="n">foo</span> <span class="p">{</span>
    <span class="n">output</span><span class="p">:</span>
      <span class="n">path</span> <span class="s1">&#39;foo.txt&#39;</span>
    <span class="n">script</span><span class="p">:</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      your_command &gt; foo.txt</span>
<span class="sd">      &quot;&quot;&quot;</span>
<span class="p">}</span>

 <span class="n">process</span> <span class="n">bar</span> <span class="p">{</span>
    <span class="nb">input</span><span class="p">:</span>
      <span class="n">path</span> <span class="n">x</span>
    <span class="n">output</span><span class="p">:</span>
      <span class="n">path</span> <span class="s1">&#39;bar.txt&#39;</span>
    <span class="n">script</span><span class="p">:</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      another_command $x &gt; bar.txt</span>
<span class="sd">      &quot;&quot;&quot;</span>
<span class="p">}</span>

<span class="n">workflow</span> <span class="p">{</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">fromPath</span><span class="p">(</span><span class="s1">&#39;/some/path/*.txt&#39;</span><span class="p">)</span>
    <span class="n">foo</span><span class="p">()</span>
    <span class="n">bar</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">A process component can be invoked only once in the same workflow context.</p>
</div>
</div>
<div class="section" id="process-composition">
<h3>Process composition<a class="headerlink" href="#process-composition" title="Permalink to this headline">¶</a></h3>
<p>Processes having matching <em>input-output</em> declaration can be composed so that the output
of the first process is passed as input to the following process. Taking in consideration
the previous process definition, it's possible to write the following:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">workflow</span> <span class="p">{</span>
    <span class="n">bar</span><span class="p">(</span><span class="n">foo</span><span class="p">())</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="process-outputs">
<h3>Process outputs<a class="headerlink" href="#process-outputs" title="Permalink to this headline">¶</a></h3>
<p>A process output can also be accessed using the <code class="docutils literal"><span class="pre">out</span></code> attribute for the respective
process object. For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">workflow</span> <span class="p">{</span>
    <span class="n">foo</span><span class="p">()</span>
    <span class="n">bar</span><span class="p">(</span><span class="n">foo</span><span class="o">.</span><span class="n">out</span><span class="p">)</span>
    <span class="n">bar</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">view</span><span class="p">()</span>
<span class="p">}</span>
</pre></div>
</div>
<p>When a process defines two or more output channels, each of them can be accessed
using the array element operator e.g. <code class="docutils literal"><span class="pre">out[0]</span></code>, <code class="docutils literal"><span class="pre">out[1]</span></code>, etc. or using
<em>named outputs</em> (see below).</p>
</div>
<div class="section" id="process-named-output">
<h3>Process named output<a class="headerlink" href="#process-named-output" title="Permalink to this headline">¶</a></h3>
<p>The process output definition allow the use of the <code class="docutils literal"><span class="pre">emit</span></code> option to define a name identifier
that can be used to reference the channel in external scope. For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">foo</span> <span class="p">{</span>
  <span class="n">output</span><span class="p">:</span>
    <span class="n">path</span> <span class="s1">&#39;*.bam&#39;</span><span class="p">,</span> <span class="n">emit</span><span class="p">:</span> <span class="n">samples_bam</span>

  <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">  your_command --here</span>
<span class="sd">  &#39;&#39;&#39;</span>
<span class="p">}</span>

<span class="n">workflow</span> <span class="p">{</span>
    <span class="n">foo</span><span class="p">()</span>
    <span class="n">foo</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">samples_bam</span><span class="o">.</span><span class="n">view</span><span class="p">()</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="workflow">
<h2>Workflow<a class="headerlink" href="#workflow" title="Permalink to this headline">¶</a></h2>
<div class="section" id="workflow-definition">
<h3>Workflow definition<a class="headerlink" href="#workflow-definition" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">workflow</span></code> keyword allows the definition of sub-workflow components that enclose the
invocation of one or more processes and operators:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">workflow</span> <span class="n">my_pipeline</span> <span class="p">{</span>
    <span class="n">foo</span><span class="p">()</span>
    <span class="n">bar</span><span class="p">(</span> <span class="n">foo</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span> <span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>For example, the above snippet defines a workflow component, named <code class="docutils literal"><span class="pre">my_pipeline</span></code>, that can be invoked from
another workflow component definition as any other function or process i.e. <code class="docutils literal"><span class="pre">my_pipeline()</span></code>.</p>
</div>
<div class="section" id="workflow-parameters">
<h3>Workflow parameters<a class="headerlink" href="#workflow-parameters" title="Permalink to this headline">¶</a></h3>
<p>A workflow component can access any variable and parameter defined in the outer scope:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">params</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;/some/data/file&#39;</span>

<span class="n">workflow</span> <span class="n">my_pipeline</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">params</span><span class="o">.</span><span class="n">data</span> <span class="p">)</span>
        <span class="n">bar</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="k">else</span>
        <span class="n">bar</span><span class="p">(</span><span class="n">foo</span><span class="p">())</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="workflow-inputs">
<h3>Workflow inputs<a class="headerlink" href="#workflow-inputs" title="Permalink to this headline">¶</a></h3>
<p>A workflow component can declare one or more input channels using the <code class="docutils literal"><span class="pre">take</span></code> keyword. For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">workflow</span> <span class="n">my_pipeline</span> <span class="p">{</span>
    <span class="n">take</span><span class="p">:</span> <span class="n">data</span>
    <span class="n">main</span><span class="p">:</span>
    <span class="n">foo</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">bar</span><span class="p">(</span><span class="n">foo</span><span class="o">.</span><span class="n">out</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">When the <code class="docutils literal"><span class="pre">take</span></code> is used the beginning of the workflow body needs to be identified with the
<code class="docutils literal"><span class="pre">main</span></code> keyword.</p>
</div>
<p>Then, the input can be specified a argument on the workflow invocation statement:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">workflow</span> <span class="p">{</span>
    <span class="n">my_pipeline</span><span class="p">(</span> <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="s1">&#39;/some/data&#39;</span><span class="p">)</span> <span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Workflow inputs are by definition <em>channel</em> data structure. If a basic data type is provided
instead, ie. number, string, list, etc. it's implicitly converted to a <a class="reference internal" href="channel.html#channel-type-value"><span class="std std-ref">channel value</span></a> (ie. non-consumable).</p>
</div>
</div>
<div class="section" id="workflow-outputs">
<h3>Workflow outputs<a class="headerlink" href="#workflow-outputs" title="Permalink to this headline">¶</a></h3>
<p>A workflow component can declare one or more out channels using the <code class="docutils literal"><span class="pre">emit</span></code> keyword. For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">workflow</span> <span class="n">my_pipeline</span> <span class="p">{</span>
    <span class="n">main</span><span class="p">:</span>
      <span class="n">foo</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
      <span class="n">bar</span><span class="p">(</span><span class="n">foo</span><span class="o">.</span><span class="n">out</span><span class="p">)</span>
    <span class="n">emit</span><span class="p">:</span>
      <span class="n">bar</span><span class="o">.</span><span class="n">out</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Then, the result of the <code class="docutils literal"><span class="pre">my_pipeline</span></code> execution can be accessed using the <code class="docutils literal"><span class="pre">out</span></code> property ie.
<code class="docutils literal"><span class="pre">my_pipeline.out</span></code>. When is declared more than one output channels, use the array bracket notation
to access each output component as described for the <a class="reference internal" href="#process-outputs">Process outputs</a> definition.</p>
<p>Alternatively, the output channel can be accessed using the identifier name to which it's assigned
in the <code class="docutils literal"><span class="pre">emit</span></code> declaration:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span> <span class="n">workflow</span> <span class="n">my_pipeline</span> <span class="p">{</span>
    <span class="n">main</span><span class="p">:</span>
      <span class="n">foo</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
      <span class="n">bar</span><span class="p">(</span><span class="n">foo</span><span class="o">.</span><span class="n">out</span><span class="p">)</span>
    <span class="n">emit</span><span class="p">:</span>
      <span class="n">my_data</span> <span class="o">=</span> <span class="n">bar</span><span class="o">.</span><span class="n">out</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Then, the result of the above snippet can accessed using the <code class="docutils literal"><span class="pre">my_pipeline.out.my_data</span></code>.</p>
</div>
<div class="section" id="implicit-workflow">
<h3>Implicit workflow<a class="headerlink" href="#implicit-workflow" title="Permalink to this headline">¶</a></h3>
<p>A workflow definition which does not declare any name is assumed to be the main workflow and it's
implicitly executed. Therefore it's the entry point of the workflow application.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Implicit workflow definition is ignored when a script is included as module. This
allow the writing a workflow script that can be used either as a library module and as
application script.</p>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">An alternative workflow entry can be specifying using the <code class="docutils literal"><span class="pre">-entry</span></code> command line option.</p>
</div>
</div>
<div class="section" id="workflow-publish">
<h3>Workflow publish<a class="headerlink" href="#workflow-publish" title="Permalink to this headline">¶</a></h3>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p class="last">This features has been retired and it will not be included in the final DSL2 release.</p>
</div>
<p>The <code class="docutils literal"><span class="pre">publish</span></code> clause in the workflow declaration allow the definition of one or more output channels
whose content needs to be copied to a storage location of your choice. For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">workflow</span> <span class="p">{</span>
    <span class="n">main</span><span class="p">:</span>
      <span class="n">foo</span><span class="p">()</span>
      <span class="n">bar</span><span class="p">()</span>
    <span class="n">publish</span><span class="p">:</span>
      <span class="n">foo</span><span class="o">.</span><span class="n">out</span> <span class="n">to</span><span class="p">:</span> <span class="s1">&#39;/some/data/dir&#39;</span>
      <span class="n">bar</span><span class="o">.</span><span class="n">out</span> <span class="n">to</span><span class="p">:</span> <span class="s1">&#39;/some/other/dir&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="docutils literal"><span class="pre">publish</span></code> clause is only allowed in a <em>implicit workflow</em> definition.</p>
</div>
<p>The <code class="docutils literal"><span class="pre">publish</span></code> clause works in similar manner to the process <a class="reference internal" href="process.html#process-publishdir"><span class="std std-ref">publishDir</span></a> directive,
however the former allow you to specify a different target directory for each published channel.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">In the <code class="docutils literal"><span class="pre">publish</span></code> clause can be specified the same options as for the <a class="reference internal" href="process.html#process-publishdir"><span class="std std-ref">publishDir</span></a>
directive i.e. <code class="docutils literal"><span class="pre">mode</span></code>, <code class="docutils literal"><span class="pre">overwrite</span></code>, <code class="docutils literal"><span class="pre">enabled</span></code>, etc.</p>
</div>
</div>
<div class="section" id="workflow-composition">
<h3>Workflow composition<a class="headerlink" href="#workflow-composition" title="Permalink to this headline">¶</a></h3>
<p>Workflow defined in your script or import by a module inclusion can be invoked and composed
as any other process in your application.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">workflow</span> <span class="n">flow1</span> <span class="p">{</span>
    <span class="n">take</span><span class="p">:</span> <span class="n">data</span>
    <span class="n">main</span><span class="p">:</span>
        <span class="n">foo</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">bar</span><span class="p">(</span><span class="n">foo</span><span class="o">.</span><span class="n">out</span><span class="p">)</span>
    <span class="n">emit</span><span class="p">:</span>
        <span class="n">bar</span><span class="o">.</span><span class="n">out</span>
<span class="p">}</span>

<span class="n">workflow</span> <span class="n">flow2</span> <span class="p">{</span>
    <span class="n">take</span><span class="p">:</span> <span class="n">data</span>
    <span class="n">main</span><span class="p">:</span>
        <span class="n">foo</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">baz</span><span class="p">(</span><span class="n">foo</span><span class="o">.</span><span class="n">out</span><span class="p">)</span>
    <span class="n">emit</span><span class="p">:</span>
        <span class="n">baz</span><span class="o">.</span><span class="n">out</span>
<span class="p">}</span>

<span class="n">workflow</span> <span class="p">{</span>
    <span class="n">take</span><span class="p">:</span> <span class="n">data</span>
    <span class="n">main</span><span class="p">:</span>
      <span class="n">flow1</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
      <span class="n">flow2</span><span class="p">(</span><span class="n">flow1</span><span class="o">.</span><span class="n">out</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Nested workflow execution determines an implicit scope. Therefore the same process can be
invoked in two different workflow scopes, like for example <code class="docutils literal"><span class="pre">foo</span></code> in the above snippet that
is used either in <code class="docutils literal"><span class="pre">flow1</span></code> and <code class="docutils literal"><span class="pre">flow2</span></code>. The workflow execution path along with the
process names defines the process <em>fully qualified name</em> that is used to distinguish the
two different process invocation i.e. <code class="docutils literal"><span class="pre">flow1:foo</span></code> and <code class="docutils literal"><span class="pre">flow2:foo</span></code> in the above example.</p>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">The process fully qualified name can be used as a valid <a class="reference internal" href="config.html#config-process-selectors"><span class="std std-ref">process selector</span></a> in the
<code class="docutils literal"><span class="pre">nextflow.config</span></code> file and it has priority over the process simple name.</p>
</div>
</div>
</div>
<div class="section" id="modules">
<h2>Modules<a class="headerlink" href="#modules" title="Permalink to this headline">¶</a></h2>
<p>The new DSL allows the definition module scripts that
can be included and shared across workflow applications.</p>
<p>A module can contain the definition of function, process and workflow definitions
as described in the above sections.</p>
<div class="section" id="modules-include">
<h3>Modules include<a class="headerlink" href="#modules-include" title="Permalink to this headline">¶</a></h3>
<p>A component defined in a module script can be imported into another Nextflow script using the <code class="docutils literal"><span class="pre">include</span></code> keyword.</p>
<p>For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">include</span> <span class="n">foo</span> <span class="kn">from</span> <span class="s1">&#39;./some/module&#39;</span>

<span class="n">workflow</span> <span class="p">{</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">fromPath</span><span class="p">(</span><span class="s1">&#39;/some/data/*.txt&#39;</span><span class="p">)</span>
    <span class="n">foo</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The above snippets includes a process with name <code class="docutils literal"><span class="pre">foo</span></code> defined in the module script in the main
execution context, as such it can be invoked in the <code class="docutils literal"><span class="pre">workflow</span></code> scope.</p>
<p>Nextflow implicitly looks for the script file <code class="docutils literal"><span class="pre">./some/module.nf</span></code> resolving the path
against the <em>including</em> script location.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Relative paths must begin with the <code class="docutils literal"><span class="pre">./</span></code> prefix.</p>
</div>
</div>
<div class="section" id="multiple-inclusions">
<h3>Multiple inclusions<a class="headerlink" href="#multiple-inclusions" title="Permalink to this headline">¶</a></h3>
<p>A Nextflow script allows the inclusion of any number of modules. When multiple
components need to be included from the some module script the component names can be
specified in the same inclusion using the curly brackets notation as shown below:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">include</span> <span class="p">{</span> <span class="n">foo</span><span class="p">;</span> <span class="n">bar</span> <span class="p">}</span> <span class="kn">from</span> <span class="s1">&#39;./some/module&#39;</span>

<span class="n">workflow</span> <span class="p">{</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">fromPath</span><span class="p">(</span><span class="s1">&#39;/some/data/*.txt&#39;</span><span class="p">)</span>
    <span class="n">foo</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">bar</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="module-aliases">
<h3>Module aliases<a class="headerlink" href="#module-aliases" title="Permalink to this headline">¶</a></h3>
<p>When including a module component it's possible to specify a name <em>alias</em>.
This allows the inclusion and the invocation of the same component multiple times
in your script using different names. For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">include</span> <span class="n">foo</span> <span class="kn">from</span> <span class="s1">&#39;./some/module&#39;</span>
<span class="n">include</span> <span class="n">foo</span> <span class="k">as</span> <span class="n">bar</span> <span class="kn">from</span> <span class="s1">&#39;./other/module&#39;</span>

<span class="n">workflow</span> <span class="p">{</span>
    <span class="n">foo</span><span class="p">(</span><span class="n">some_data</span><span class="p">)</span>
    <span class="n">bar</span><span class="p">(</span><span class="n">other_data</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The same is possible when using the curly delimited  inclusion as shown below:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">include</span> <span class="p">{</span> <span class="n">foo</span><span class="p">;</span> <span class="n">foo</span> <span class="k">as</span> <span class="n">bar</span> <span class="p">}</span> <span class="kn">from</span> <span class="s1">&#39;./some/module&#39;</span>

<span class="n">workflow</span> <span class="p">{</span>
    <span class="n">foo</span><span class="p">(</span><span class="n">some_data</span><span class="p">)</span>
    <span class="n">bar</span><span class="p">(</span><span class="n">other_data</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="module-parameters">
<h3>Module parameters<a class="headerlink" href="#module-parameters" title="Permalink to this headline">¶</a></h3>
<p>A module script can define one or more parameters using the same syntax of a Nextflow workflow script:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">params</span><span class="o">.</span><span class="n">foo</span> <span class="o">=</span> <span class="s1">&#39;Hello&#39;</span>
<span class="n">params</span><span class="o">.</span><span class="n">bar</span> <span class="o">=</span> <span class="s1">&#39;world!&#39;</span>

<span class="k">def</span> <span class="nf">sayHello</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">println</span> <span class="s2">&quot;$params.foo $params.bar&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Then, parameters are inherited from the including context. For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">params</span><span class="o">.</span><span class="n">foo</span> <span class="o">=</span> <span class="s1">&#39;Hola&#39;</span>
<span class="n">params</span><span class="o">.</span><span class="n">bar</span> <span class="o">=</span> <span class="s1">&#39;Mundo&#39;</span>

<span class="n">include</span> <span class="p">{</span><span class="n">sayHello</span><span class="p">}</span> <span class="kn">from</span> <span class="s1">&#39;./some/module&#39;</span>

<span class="n">workflow</span> <span class="p">{</span>
    <span class="n">sayHello</span><span class="p">()</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The above snippet prints:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Hola</span> <span class="n">mundo</span>
</pre></div>
</div>
<p>The option <code class="docutils literal"><span class="pre">addParams</span></code> can be used to extend the module parameters without affecting the external
scope. For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">include</span> <span class="p">{</span><span class="n">sayHello</span><span class="p">}</span> <span class="kn">from</span> <span class="s1">&#39;./some/module&#39;</span> <span class="n">addParams</span><span class="p">(</span><span class="n">foo</span><span class="p">:</span> <span class="s1">&#39;Ciao&#39;</span><span class="p">)</span>

<span class="n">workflow</span> <span class="p">{</span>
    <span class="n">sayHello</span><span class="p">()</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The above snippet prints:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>Ciao world!
</pre></div>
</div>
<p>Finally the include option <code class="docutils literal"><span class="pre">params</span></code> allows the specification of one or more parameters without
inheriting any value from the external environment.</p>
</div>
</div>
<div class="section" id="channel-forking">
<h2>Channel forking<a class="headerlink" href="#channel-forking" title="Permalink to this headline">¶</a></h2>
<p>Using the new DSL Nextflow channels are automatically forked when connecting two or more consumers.</p>
<p>For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Channel</span>
    <span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">,</span><span class="s1">&#39;Hola&#39;</span><span class="p">,</span><span class="s1">&#39;Ciao&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">set</span><span class="p">{</span> <span class="n">cheers</span> <span class="p">}</span>

<span class="n">cheers</span>
    <span class="o">.</span><span class="n">map</span><span class="p">{</span> <span class="n">it</span><span class="o">.</span><span class="n">toUpperCase</span><span class="p">()</span> <span class="p">}</span>
    <span class="o">.</span><span class="n">view</span><span class="p">()</span>

<span class="n">cheers</span>
    <span class="o">.</span><span class="n">map</span><span class="p">{</span> <span class="n">it</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span> <span class="p">}</span>
    <span class="o">.</span><span class="n">view</span><span class="p">()</span>
</pre></div>
</div>
<p>The same is valid for the result (channel) of a process execution. Therefore a process output can be used by
two or more processes without the need to fork them using the <a class="reference internal" href="operator.html#operator-into"><span class="std std-ref">into</span></a> operator, making the
writing of workflow script much fluent and readable.</p>
</div>
<div class="section" id="pipes">
<h2>Pipes<a class="headerlink" href="#pipes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="the-pipe-operator">
<h3>The <em>pipe</em> operator<a class="headerlink" href="#the-pipe-operator" title="Permalink to this headline">¶</a></h3>
<p>Nextflow processes and operators can be composed using the <code class="docutils literal"><span class="pre">|</span></code> <em>pipe</em> operator. For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">foo</span> <span class="p">{</span>
    <span class="nb">input</span><span class="p">:</span> <span class="n">val</span> <span class="n">data</span>
    <span class="n">output</span><span class="p">:</span> <span class="n">val</span> <span class="n">result</span>
    <span class="n">exec</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;$data world&quot;</span>
<span class="p">}</span>

<span class="n">workflow</span> <span class="p">{</span>
   <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">,</span><span class="s1">&#39;Hola&#39;</span><span class="p">,</span><span class="s1">&#39;Ciao&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="n">foo</span> <span class="o">|</span> <span class="nb">map</span> <span class="p">{</span> <span class="n">it</span><span class="o">.</span><span class="n">toUpperCase</span><span class="p">()</span> <span class="p">}</span> <span class="o">|</span> <span class="n">view</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The above snippet defines a process named <code class="docutils literal"><span class="pre">foo</span></code> then invoke it passing the content of the
<code class="docutils literal"><span class="pre">data</span></code> channel. The result is piped to the <a class="reference internal" href="operator.html#operator-map"><span class="std std-ref">map</span></a> operator which converts each string
to uppercase and finally, the last <a class="reference internal" href="operator.html#operator-view"><span class="std std-ref">view</span></a> prints it.</p>
</div>
<div class="section" id="the-and-operator">
<h3>The <em>and</em> operator<a class="headerlink" href="#the-and-operator" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">&amp;</span></code> <em>and</em> operator allow the feed of two or more processes with the content of the same
channel(s) e.g.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">foo</span> <span class="p">{</span>
  <span class="nb">input</span><span class="p">:</span> <span class="n">val</span> <span class="n">data</span>
  <span class="n">output</span><span class="p">:</span> <span class="n">val</span> <span class="n">result</span>
  <span class="n">exec</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;$data world&quot;</span>
<span class="p">}</span>

<span class="n">process</span> <span class="n">bar</span> <span class="p">{</span>
    <span class="nb">input</span><span class="p">:</span> <span class="n">val</span> <span class="n">data</span>
    <span class="n">output</span><span class="p">:</span> <span class="n">val</span> <span class="n">result</span>
    <span class="n">exec</span><span class="p">:</span>
      <span class="n">result</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">toUpperCase</span><span class="p">()</span>
<span class="p">}</span>

<span class="n">workflow</span> <span class="p">{</span>
   <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="nb">map</span> <span class="p">{</span> <span class="n">it</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span> <span class="p">}</span> <span class="o">|</span> <span class="p">(</span><span class="n">foo</span> <span class="o">&amp;</span> <span class="n">bar</span><span class="p">)</span> <span class="o">|</span> <span class="n">mix</span> <span class="o">|</span> <span class="n">view</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the above snippet the channel emitting the <code class="docutils literal"><span class="pre">Hello</span></code> is piped with the <a class="reference internal" href="operator.html#operator-map"><span class="std std-ref">map</span></a>
which reverse the string value. Then, the result is passed to either <code class="docutils literal"><span class="pre">foo</span></code> and <code class="docutils literal"><span class="pre">bar</span></code>
processes which are executed in parallel. The result is pair of channels which content
is merged into a single channel using the <a class="reference internal" href="operator.html#operator-mix"><span class="std std-ref">mix</span></a>. Finally the result is printed
using the <a class="reference internal" href="operator.html#operator-view"><span class="std std-ref">view</span></a>.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">The break-line operator <code class="docutils literal"><span class="pre">\</span></code> can be use to split long pipes concatenation
over multiple lines.</p>
</div>
<p>The above snippet can be written as shown below:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">workflow</span> <span class="p">{</span>
   <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">)</span> \
     <span class="o">|</span> <span class="nb">map</span> <span class="p">{</span> <span class="n">it</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span> <span class="p">}</span> \
     <span class="o">|</span> <span class="p">(</span><span class="n">foo</span> <span class="o">&amp;</span> <span class="n">bar</span><span class="p">)</span> \
     <span class="o">|</span> <span class="n">mix</span> \
     <span class="o">|</span> <span class="n">view</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="deprecated-methods-and-operators">
<h2>Deprecated methods and operators<a class="headerlink" href="#deprecated-methods-and-operators" title="Permalink to this headline">¶</a></h2>
<p>The following methods are not allowed any more when using Nextflow DSL 2:</p>
<ul class="simple">
<li><a class="reference internal" href="channel.html#channel-create"><span class="std std-ref">create</span></a></li>
<li><a class="reference internal" href="channel.html#channel-bind1"><span class="std std-ref">bind</span></a></li>
<li><a class="reference internal" href="channel.html#channel-bind2"><span class="std std-ref">operator &lt;&lt;</span></a></li>
<li><a class="reference internal" href="operator.html#operator-choice"><span class="std std-ref">choice</span></a></li>
<li><a class="reference internal" href="operator.html#operator-close"><span class="std std-ref">close</span></a></li>
<li><a class="reference internal" href="operator.html#operator-countby"><span class="std std-ref">countBy</span></a></li>
<li>route</li>
<li><a class="reference internal" href="operator.html#operator-separate"><span class="std std-ref">separate</span></a></li>
<li><a class="reference internal" href="operator.html#operator-into"><span class="std std-ref">into</span></a></li>
<li><a class="reference internal" href="operator.html#operator-merge"><span class="std std-ref">merge</span></a></li>
</ul>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="awscloud.html" class="btn btn-neutral float-right" title="Amazon Cloud" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="config.html" class="btn btn-neutral" title="Configuration" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2013-2019, Centre for Genomic Regulation (CRG).
      Licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'https://www.nextflow.io/docs/latest/index.html',
            VERSION:'20.04.1-edge',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

  <script>
  if( window.location.hostname == 'localhost' || window.location.hostname == '127.0.0.1' ) { throw new Error('Skip GA on localhost') };
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-364526-10', 'auto');
  ga('send', 'pageview');
  </script>
</body>
</html>