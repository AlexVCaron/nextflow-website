

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Apache Ignite &mdash; Nextflow 0.22.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  

    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:'./',
        VERSION:'0.22.0',
        COLLAPSE_INDEX:false,
        FILE_SUFFIX:'.html',
        HAS_SOURCE:  true
      };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
    <script type="text/javascript">
        jQuery(function () {
            SphinxRtdTheme.StickyNav.enable();
        });
    </script>
  

  
    <link rel="top" title="Nextflow 0.22.0 documentation" href="index.html"/>
        <link rel="next" title="Tracing &amp; visualisation" href="tracing.html"/>
        <link rel="prev" title="Docker containers" href="docker.html"/> 

  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" class="fa fa-home"> Nextflow</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getstarted.html">Get started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="getstarted.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="getstarted.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="getstarted.html#your-first-script">Your first script</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="basic.html">Basic concepts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="basic.html#processes-and-channels">Processes and channels</a></li>
<li class="toctree-l2"><a class="reference internal" href="basic.html#execution-abstraction">Execution abstraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="basic.html#scripting-language">Scripting language</a></li>
<li class="toctree-l2"><a class="reference internal" href="basic.html#configuration-options">Configuration options</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="script.html">Pipeline script</a><ul>
<li class="toctree-l2"><a class="reference internal" href="script.html#language-basics">Language basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="script.html#closures">Closures</a></li>
<li class="toctree-l2"><a class="reference internal" href="script.html#regular-expressions">Regular expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="script.html#files-and-i-o">Files and I/O</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="process.html">Processes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="process.html#script">Script</a></li>
<li class="toctree-l2"><a class="reference internal" href="process.html#inputs">Inputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="process.html#outputs">Outputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="process.html#when">When</a></li>
<li class="toctree-l2"><a class="reference internal" href="process.html#directives">Directives</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="channel.html">Channels</a><ul>
<li class="toctree-l2"><a class="reference internal" href="channel.html#channel-factory">Channel factory</a></li>
<li class="toctree-l2"><a class="reference internal" href="channel.html#binding-values">Binding values</a></li>
<li class="toctree-l2"><a class="reference internal" href="channel.html#observing-events">Observing events</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="operator.html">Operators</a><ul>
<li class="toctree-l2"><a class="reference internal" href="operator.html#filtering-operators">Filtering operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="operator.html#transforming-operators">Transforming operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="operator.html#splitting-operators">Splitting operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="operator.html#combining-operators">Combining operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="operator.html#forking-operators">Forking operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="operator.html#maths-operators">Maths operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="operator.html#other-operators">Other operators</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="executor.html">Executors</a><ul>
<li class="toctree-l2"><a class="reference internal" href="executor.html#local">Local</a></li>
<li class="toctree-l2"><a class="reference internal" href="executor.html#sge">SGE</a></li>
<li class="toctree-l2"><a class="reference internal" href="executor.html#lsf">LSF</a></li>
<li class="toctree-l2"><a class="reference internal" href="executor.html#slurm">SLURM</a></li>
<li class="toctree-l2"><a class="reference internal" href="executor.html#pbs-torque">PBS/Torque</a></li>
<li class="toctree-l2"><a class="reference internal" href="executor.html#htcondor">HTCondor</a></li>
<li class="toctree-l2"><a class="reference internal" href="executor.html#drmaa">DRMAA</a></li>
<li class="toctree-l2"><a class="reference internal" href="executor.html#dnanexus">DNAnexus</a></li>
<li class="toctree-l2"><a class="reference internal" href="executor.html#ignite">Ignite</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="config.html#configuration-file">Configuration file</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#config-scopes">Config scopes</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#config-profiles">Config profiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#environment-variables">Environment variables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="awscloud.html">Amazon Cloud</a><ul>
<li class="toctree-l2"><a class="reference internal" href="awscloud.html#configuration">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="awscloud.html#cluster-deployment">Cluster deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="awscloud.html#pipeline-execution">Pipeline execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="awscloud.html#cluster-shutdown">Cluster shutdown</a></li>
<li class="toctree-l2"><a class="reference internal" href="awscloud.html#cluster-auto-scaling">Cluster auto-scaling</a></li>
<li class="toctree-l2"><a class="reference internal" href="awscloud.html#spot-prices">Spot prices</a></li>
<li class="toctree-l2"><a class="reference internal" href="awscloud.html#advanced-configuration">Advanced configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="amazons3.html">Amazon S3 storage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="amazons3.html#s3-path">S3 path</a></li>
<li class="toctree-l2"><a class="reference internal" href="amazons3.html#security-credentials">Security credentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="amazons3.html#advanced-configuration">Advanced configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dnanexus.html">DNAnexus cloud</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dnanexus.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="dnanexus.html#app-packing">App packing</a></li>
<li class="toctree-l2"><a class="reference internal" href="dnanexus.html#execution">Execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="dnanexus.html#how-it-works">How it works</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="docker.html">Docker containers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="docker.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="docker.html#how-it-works">How it works</a></li>
<li class="toctree-l2"><a class="reference internal" href="docker.html#multiple-containers">Multiple containers</a></li>
<li class="toctree-l2"><a class="reference internal" href="docker.html#executable-containers">Executable containers</a></li>
<li class="toctree-l2"><a class="reference internal" href="docker.html#advanced-settings">Advanced settings</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Apache Ignite</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#cluster-daemon">Cluster daemon</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pipeline-execution">Pipeline execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="#execution-with-mpi">Execution with MPI</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tracing.html">Tracing &amp; visualisation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tracing.html#execution-report">Execution report</a></li>
<li class="toctree-l2"><a class="reference internal" href="tracing.html#timeline-report">Timeline report</a></li>
<li class="toctree-l2"><a class="reference internal" href="tracing.html#dag-visualisation">DAG visualisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="tracing.html#extrae-integration">Extrae integration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="sharing.html">Pipeline sharing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="sharing.html#how-it-works">How it works</a></li>
<li class="toctree-l2"><a class="reference internal" href="sharing.html#running-a-pipeline">Running a pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="sharing.html#handling-revisions">Handling revisions</a></li>
<li class="toctree-l2"><a class="reference internal" href="sharing.html#commands-to-manage-projects">Commands to manage projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="sharing.html#scm-configuration-file">SCM configuration file</a></li>
<li class="toctree-l2"><a class="reference internal" href="sharing.html#private-server-configuration">Private server configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="sharing.html#publishing-your-pipeline">Publishing your pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="sharing.html#manage-dependencies">Manage dependencies</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="metadata.html">Workflow introspection</a><ul>
<li class="toctree-l2"><a class="reference internal" href="metadata.html#runtime-metadata">Runtime metadata</a></li>
<li class="toctree-l2"><a class="reference internal" href="metadata.html#completion-handler">Completion handler</a></li>
<li class="toctree-l2"><a class="reference internal" href="metadata.html#error-handler">Error handler</a></li>
<li class="toctree-l2"><a class="reference internal" href="metadata.html#notification-message">Notification message</a></li>
<li class="toctree-l2"><a class="reference internal" href="metadata.html#decoupling-metadata">Decoupling metadata</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="example.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="example.html#basic-pipeline">Basic pipeline</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Nextflow</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Apache Ignite</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="apache-ignite">
<span id="ignite-page"></span><h1>Apache Ignite<a class="headerlink" href="#apache-ignite" title="Permalink to this headline">¶</a></h1>
<p>Nextflow can be be deployed in a <em>cluster</em> mode by using <a class="reference external" href="https://ignite.apache.org/">Apache Ignite</a>, an in-memory data-grid
and clustering platform.</p>
<p>Apache Ignite is packaged with Nextflow itself, so you won't need to install it separately or configure other third party
software.</p>
<div class="section" id="cluster-daemon">
<span id="ignite-daemon"></span><h2>Cluster daemon<a class="headerlink" href="#cluster-daemon" title="Permalink to this headline">¶</a></h2>
<p>In order to setup a cluster you will need to run a cluster daemon on each node within your cluster.
If you want to support the <a class="reference internal" href="docker.html#docker-page"><span class="std std-ref">Docker integration</span></a> feature provided by Nextflow, the Docker engine has
to be installed and must run in each node.</p>
<p>In its simplest form just launch the Nextflow daemon in each cluster node as shown below:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nextflow</span> <span class="n">node</span> <span class="o">-</span><span class="n">bg</span>
</pre></div>
</div>
<p>The command line option <code class="docutils literal"><span class="pre">-bg</span></code> launches the node daemon in the background. The output is stored in the log file <code class="docutils literal"><span class="pre">.node-nextflow.log</span></code>. The daemon
process <code class="docutils literal"><span class="pre">PID</span></code> is saved in the file <code class="docutils literal"><span class="pre">.nextflow.pid</span></code> in the same folder.</p>
<div class="section" id="multicast-discovery">
<h3>Multicast discovery<a class="headerlink" href="#multicast-discovery" title="Permalink to this headline">¶</a></h3>
<p>By default, the Ignite daemon tries to automatically discover all members in the cluster by using the network <em>multicast</em> discovery.
Note that NOT all networks support this feature (for example Amazon AWS does not).</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">To check if multicast is available in your network, use the <a class="reference external" href="http://sourceforge.net/projects/iperf/">iperf</a> tool.
To test multicast, open a terminal on two machines within the network and run the following command in the first one
<code class="docutils literal"><span class="pre">iperf</span> <span class="pre">-s</span> <span class="pre">-u</span> <span class="pre">-B</span> <span class="pre">228.1.2.4</span> <span class="pre">-i</span> <span class="pre">1</span></code> and <code class="docutils literal"><span class="pre">iperf</span> <span class="pre">-c</span> <span class="pre">228.1.2.4</span> <span class="pre">-u</span> <span class="pre">-T</span> <span class="pre">32</span> <span class="pre">-t</span> <span class="pre">3</span> <span class="pre">-i</span> <span class="pre">1</span></code> on the second.
If data is being transferred then multicast is working.</p>
</div>
<p>Ignite uses the multicast group <code class="docutils literal"><span class="pre">228.1.2.4</span></code> and port <code class="docutils literal"><span class="pre">47400</span></code> by default. You can change these values, by using the
<code class="docutils literal"><span class="pre">cluster.join</span></code> command line option, as shown below:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nextflow</span> <span class="n">node</span> <span class="o">-</span><span class="n">cluster</span><span class="o">.</span><span class="n">join</span> <span class="n">multicast</span><span class="p">:</span><span class="mf">224.2</span><span class="o">.</span><span class="mf">2.3</span><span class="p">:</span><span class="mi">55701</span>
</pre></div>
</div>
<p>In case multicast discovery is not available in your network, you can try one of the following alternative methods:</p>
</div>
<div class="section" id="shared-file-system">
<h3>Shared file system<a class="headerlink" href="#shared-file-system" title="Permalink to this headline">¶</a></h3>
<p>Simply provide a path shared across the cluster by a network file system, as shown below:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nextflow</span> <span class="n">node</span> <span class="o">-</span><span class="n">bg</span> <span class="o">-</span><span class="n">cluster</span><span class="o">.</span><span class="n">join</span> <span class="n">path</span><span class="p">:</span><span class="o">/</span><span class="n">net</span><span class="o">/</span><span class="n">shared</span><span class="o">/</span><span class="n">cluster</span>
</pre></div>
</div>
<p>The cluster members will use that path to discover each other.</p>
</div>
<div class="section" id="ip-addresses">
<h3>IP addresses<a class="headerlink" href="#ip-addresses" title="Permalink to this headline">¶</a></h3>
<p>Provide a list of pre-configured IP addresses on the daemon launch command line, for example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nextflow</span> <span class="n">node</span> <span class="o">-</span><span class="n">cluster</span><span class="o">.</span><span class="n">join</span> <span class="n">ip</span><span class="p">:</span><span class="mf">10.0</span><span class="o">.</span><span class="mf">2.1</span><span class="p">,</span><span class="mf">10.0</span><span class="o">.</span><span class="mf">2.2</span><span class="p">,</span><span class="mf">10.0</span><span class="o">.</span><span class="mf">2.4</span>
</pre></div>
</div>
</div>
<div class="section" id="aws-s3-bucket">
<h3>AWS S3 bucket<a class="headerlink" href="#aws-s3-bucket" title="Permalink to this headline">¶</a></h3>
<p>Creates an Amazon AWS S3 bucket that will hold the cluster member's IP addresses. For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nextflow</span> <span class="n">node</span> <span class="o">-</span><span class="n">cluster</span><span class="o">.</span><span class="n">join</span> <span class="n">s3</span><span class="p">:</span><span class="n">cluster_bucket</span>
</pre></div>
</div>
</div>
<div class="section" id="advanced-options">
<h3>Advanced options<a class="headerlink" href="#advanced-options" title="Permalink to this headline">¶</a></h3>
<p>The following cluster node configuration options can be used.</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>join</td>
<td>IP address(es) of one or more cluster nodes to which the daemon will join.</td>
</tr>
<tr class="row-odd"><td>group</td>
<td>The name of the cluster to which this node join. It allows the creation of separate cluster instances. Default: <code class="docutils literal"><span class="pre">nextflow</span></code></td>
</tr>
<tr class="row-even"><td>maxCpus</td>
<td>Max number of CPUs that can be used by the daemon to run user tasks. By default it is equal to the number of CPU cores.</td>
</tr>
<tr class="row-odd"><td>maxDisk</td>
<td>Max amount of disk storage that can be used by user tasks eg. <code class="docutils literal"><span class="pre">500</span> <span class="pre">GB</span></code>.</td>
</tr>
<tr class="row-even"><td>maxMemory</td>
<td>Max amount of memory that can be used by user tasks eg. <code class="docutils literal"><span class="pre">64</span> <span class="pre">GB</span></code>. Default total available memory.</td>
</tr>
<tr class="row-odd"><td>interface</td>
<td>Network interfaces that Ignite will use. It can be the interface IP address or name.</td>
</tr>
<tr class="row-even"><td>tcp.localAddress</td>
<td>Defines the local host IP address.</td>
</tr>
<tr class="row-odd"><td>tcp.localPort</td>
<td>Defines the local port to listen to.</td>
</tr>
<tr class="row-even"><td>tcp.localPortRange</td>
<td>Range for local ports.</td>
</tr>
<tr class="row-odd"><td>tcp.heartbeatFrequency</td>
<td>Defines the delay between heartbeat messages sent by coordinator.</td>
</tr>
<tr class="row-even"><td>tcp.maxMissedHeartbeats</td>
<td>Defines max heartbeats count node can miss without initiating status check.</td>
</tr>
<tr class="row-odd"><td>tcp.reconnectCount</td>
<td>Number of times the node tries to (re)establish connection to another node.</td>
</tr>
<tr class="row-even"><td>tcp.networkTimeout</td>
<td>Defines the network timeout.</td>
</tr>
<tr class="row-odd"><td>tcp.socketTimeout</td>
<td>Defines the socket operations timeout. This timeout is used to limit connection time and write-to-socket time. Note that when running Ignite on Amazon EC2, socket timeout must be set to a value significantly greater than the default (e.g. to 30000).</td>
</tr>
<tr class="row-even"><td>tcp.ackTimeout</td>
<td>Defines the timeout for receiving acknowledgement for sent message.</td>
</tr>
<tr class="row-odd"><td>tcp.maxAckTimeout</td>
<td>Defines the maximum timeout for receiving acknowledgement for sent message.</td>
</tr>
<tr class="row-even"><td>tcp.joinTimeout</td>
<td>Defines the join timeout.</td>
</tr>
</tbody>
</table>
<p>These options can be specified as command line parameters by adding the prefix <code class="docutils literal"><span class="pre">-cluster.</span></code> to them, as shown below:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nextflow</span> <span class="n">node</span> <span class="o">-</span><span class="n">bg</span> <span class="o">-</span><span class="n">cluster</span><span class="o">.</span><span class="n">maxCpus</span> <span class="mi">4</span> <span class="o">-</span><span class="n">cluster</span><span class="o">.</span><span class="n">interface</span> <span class="n">eth0</span>
</pre></div>
</div>
<p>The same options can be entered into the Nextflow <a class="reference internal" href="config.html#config-page"><span class="std std-ref">configuration file</span></a>, as shown below:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cluster</span> <span class="p">{</span>
    <span class="n">join</span> <span class="o">=</span> <span class="s1">&#39;ip:192.168.1.104&#39;</span>
    <span class="n">interface</span> <span class="o">=</span> <span class="s1">&#39;eth0&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Finally daemon options can be provided also as environment variables having the name in upper-case and by adding
the prefix <code class="docutils literal"><span class="pre">NXF_CLUSTER_</span></code> to them, for example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">NXF_CLUSTER_JOIN</span><span class="o">=</span><span class="s1">&#39;ip:192.168.1.104&#39;</span>
<span class="n">export</span> <span class="n">NXF_CLUSTER_INTERFACE</span><span class="o">=</span><span class="s1">&#39;eth0&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="pipeline-execution">
<h2>Pipeline execution<a class="headerlink" href="#pipeline-execution" title="Permalink to this headline">¶</a></h2>
<p>The pipeline execution needs to be launched in a <cite>head</cite> node i.e. a cluster node where the Nextflow node daemon
is <strong>not</strong> running. In order to execute your pipeline in the Ignite cluster you will need to use the Ignite executor,
as shown below:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nextflow</span> <span class="n">run</span> <span class="o">&lt;</span><span class="n">your</span> <span class="n">pipeline</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">process</span><span class="o">.</span><span class="n">executor</span> <span class="n">ignite</span>
</pre></div>
</div>
<p>If your network does no support multicast discovery, you will need to specify the <cite>joining</cite> strategy as you did for the
cluster daemons. For example, using a shared path:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nextflow</span> <span class="n">run</span> <span class="o">&lt;</span><span class="n">your</span> <span class="n">pipeline</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">process</span><span class="o">.</span><span class="n">executor</span> <span class="n">ignite</span> <span class="o">-</span><span class="n">cluster</span><span class="o">.</span><span class="n">join</span> <span class="n">path</span><span class="p">:</span><span class="o">/</span><span class="n">net</span><span class="o">/</span><span class="n">shared</span><span class="o">/</span><span class="n">path</span>
</pre></div>
</div>
</div>
<div class="section" id="execution-with-mpi">
<h2>Execution with MPI<a class="headerlink" href="#execution-with-mpi" title="Permalink to this headline">¶</a></h2>
<p>Nextflow is able to deploy and self-configure an Ignite cluster on demand, taking advantage of the Open <a class="reference external" href="https://en.wikipedia.org/wiki/Message_Passing_Interface">MPI</a>
standard that is commonly available in grid and supercomputer facilities.</p>
<p>In this scenario a Nextflow workflow needs to be executed as an MPI job. Under the hood Nextflow will launch a <cite>driver</cite>
process in the first of the nodes, allocated by your job request, and an Ignite daemon in the remaining nodes.</p>
<p>In practice you will need a wrapper script to submit an MPI job request to your batch scheduler/resource manager.
The batch scheduler must reserve the computing nodes in an exclusive manner to avoid having multiple Ignite daemons
running on the same node. Nextflow must be launched using the <code class="docutils literal"><span class="pre">mpirun</span></code> utility, as if it were an MPI application,
specifying the <code class="docutils literal"><span class="pre">--pernode</span></code> option.</p>
<p>The following example shows a wrapper script for the <a class="reference external" href="https://en.wikipedia.org/wiki/Platform_LSF/">Platform LSF</a> resource manager:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>#!/bin/bash
#BSUB -oo output_%J.out
#BSUB -eo output_%J.err
#BSUB -J &lt;job name&gt;
#BSUB -q &lt;queue name&gt;
#BSUB -W 02:00
#BSUB -x
#BSUB -n 80
#BSUB -M 10240
#BSUB -R &quot;span[ptile=16]&quot;
export NXF_CLUSTER_SEED=$(shuf -i 0-16777216 -n 1)
mpirun --pernode nextflow run &lt;your-project-name&gt; -with-mpi [pipeline parameters]
</pre></div>
</div>
<p>It requests 5 nodes (80 processes, with 16 cpus per node). The <code class="docutils literal"><span class="pre">-x</span></code> directive allocates the node in an exclusive manner.
Nextflow needs to be executed using the <code class="docutils literal"><span class="pre">-with-mpi</span></code> command line option. It will automatically use <code class="docutils literal"><span class="pre">ignite</span></code> as the executor.</p>
<p>The variable <code class="docutils literal"><span class="pre">NXF_CLUSTER_SEED</span></code> must contain an integer value (in the range 0-16777216) that will unequivocally identify
your cluster instance. In the above example it is randomly generated by using the <a class="reference external" href="http://linux.die.net/man/1/shuf">shuf</a> Linux tool.</p>
<p>The following example shows a wrapper script for the <a class="reference external" href="https://en.wikipedia.org/wiki/Univa_Grid_Engine">Univa grid engine</a> (aka SGE):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>#!/bin/bash
#$ -cwd
#$ -j y
#$ -o &lt;output file name&gt;
#$ -l virtual_free=10G
#$ -q &lt;queue name&gt;
#$ -N &lt;job name&gt;
#$ -pe ompi 5
export NXF_CLUSTER_SEED=$(shuf -i 0-16777216 -n 1)
mpirun --pernode nextflow run &lt;your-project-name&gt; -with-mpi [pipeline parameters]
</pre></div>
</div>
<p>As in the previous script it allocates 5 processing nodes. UGE/SGE does not have an option to reserve a node in an exclusive
manner. A common workaround is to request the maximum amount of memory or cpus available in the nodes of your cluster.</p>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="tracing.html" class="btn btn-neutral float-right" title="Tracing &amp; visualisation"/>Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="docker.html" class="btn btn-neutral" title="Docker containers"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2013, Nextflow authors.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  

  
  <script>
  if( window.location.hostname == 'localhost' || window.location.hostname == '127.0.0.1' ) { throw new Error('Skip GA on localhost') };
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-364526-10', 'auto');
  ga('send', 'pageview');
  </script>
</body>
</html>